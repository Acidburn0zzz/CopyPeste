module CopyPeste
  class Command
    module ListResult

      # Allows a user to diplay result list generated by analysis module
      def run

        name = ''
        # Option set name
        if @opts.length == 2
          name = @opts[1].to_s
        end

        analyseResult = AnalyseResult
        if (analyseResult.count > 0)
          display_results(analyseResult, name)
        else
            @graph_com.display(12, "Nothing result generated, use a module before.")
        end
      end

      def init; end

      module_function

      # Method used by the help command in order to explain the aim of this module.
      #
      # @return [String] a string containing the command purpose.
      def helper
        "Diplay results list of analysis modules."
      end

      # Method used to display result list of module.
      #
      # @param result [Collection] collection data of result list
      # @param name [String] Name of module, could be nil
      def display_results(results, name)
        #_com.display(10, "Name: \"#{name}\"")
        # Does not work..
        # if ((name.to_s.strip.length == 0 || name.to_s == '') && results.where(:module_name => name))
        #   @graph_com.display(12, "Option fail, name #{name}, not found")
        #   return
        # end
        
        @graph_com.display(10, "Module\t| Date\n------\t| ----")
        results.each do |data|
          if (name.to_s == '' || data.module_name == name)
            @graph_com.display(10, "#{data.module_name}\t| #{data.created_at}")
          end
        end
      end
    end
  end
end
